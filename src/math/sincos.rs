use core::f32::consts::{FRAC_PI_2, FRAC_PI_4, PI};
use core::ops::{Add, Div, Mul, Rem, Sub, Neg};
use crate::math::complex::Complex;

const COS_PI_4_LOOK_UP: [f32; 1001] = [
    1.0, 0.9999996915748783, 0.9999987662997035, 0.9999972241750464, 0.9999950652018582, 0.9999922893814706, 0.999988896715596, 0.999984887206327, 0.9999802608561371, 0.9999750176678799, 0.9999691576447897, 0.9999626807904812, 0.9999555871089498, 0.9999478766045711, 0.9999395492821014, 0.9999306051466773, 0.9999210442038161, 0.9999108664594155, 0.9999000719197535, 0.9998886605914888, 0.9998766324816606, 0.9998639875976882, 0.9998507259473718, 0.9998368475388918, 0.999822352380809, 0.9998072404820648, 0.9997915118519811, 0.99977516650026, 0.999758204436984, 0.9997406256726165, 0.9997224302180006, 0.9997036180843604, 0.9996841892832999, 0.9996641438268042, 0.999643481727238, 0.9996222029973468, 0.9996003076502565, 0.9995777956994731, 0.9995546671588833, 0.9995309220427536, 0.9995065603657316, 0.9994815821428444, 0.9994559873895001, 0.9994297761214869, 0.9994029483549729, 0.999375504106507, 0.9993474433930183, 0.9993187662318158, 0.9992894726405892, 0.9992595626374083, 0.9992290362407229, 0.9991978934693634, 0.9991661343425401, 0.9991337588798437, 0.999100767101245, 0.999067159027095, 0.9990329346781247, 0.9989980940754456, 0.9989626372405491, 0.9989265641953067, 0.99888987496197, 0.9988525695631708, 0.9988146480219211, 0.9987761103616126, 0.9987369566060175, 0.9986971867792875, 0.998656800905955, 0.9986157990109317, 0.9985741811195098, 0.9985319472573612, 0.9984890974505379, 0.998445631725472, 0.998401550108975, 0.998356852628239, 0.9983115393108354, 0.9982656101847159, 0.9982190652782118, 0.9981719046200344, 0.9981241282392745, 0.9980757361654035, 0.9980267284282716, 0.9979771050581093, 0.997926866085527, 0.9978760115415145, 0.9978245414574415, 0.9977724558650571, 0.9977197547964907, 0.9976664382842505, 0.9976125063612252, 0.9975579590606826, 0.99750279641627, 0.9974470184620149, 0.9973906252323237, 0.9973336167619825, 0.9972759930861571, 0.9972177542403927, 0.9971589002606139, 0.9970994311831248, 0.997039347044609, 0.9969786478821293, 0.996917333733128, 0.9968554046354268, 0.9967928606272266, 0.9967297017471077, 0.9966659280340299, 0.9966015395273318, 0.9965365362667313, 0.9964709182923261, 0.9964046856445924, 0.9963378383643858, 0.9962703764929413, 0.9962023000718725, 0.9961336091431725, 0.9960643037492132, 0.9959943839327459, 0.9959238497369003, 0.9958527012051857, 0.99578093838149, 0.9957085613100801, 0.9956355700356019, 0.99556196460308, 0.9954877450579179, 0.9954129114458982, 0.9953374638131817, 0.9952614022063083, 0.9951847266721969, 0.9951074372581447, 0.9950295340118275, 0.9949510169813002, 0.9948718862149959, 0.9947921417617265, 0.9947117836706824, 0.9946308119914323, 0.994549226773924, 0.994467028068483, 0.9943842159258137, 0.9943007903969989, 0.9942167515334995, 0.9941320993871551, 0.9940468340101831, 0.9939609554551797, 0.993874463775119, 0.9937873590233535, 0.9936996412536138, 0.9936113105200084, 0.9935223668770244, 0.9934328103795266, 0.9933426410827579, 0.9932518590423394, 0.9931604643142699, 0.9930684569549263, 0.9929758370210633, 0.9928826045698137, 0.9927887596586877, 0.9926943023455738, 0.9925992326887378, 0.9925035507468237, 0.9924072565788528, 0.9923103502442241, 0.9922128318027144, 0.9921147013144779, 0.9920159588400463, 0.9919166044403294, 0.9918166381766134, 0.9917160601105629, 0.9916148703042192, 0.9915130688200017, 0.9914106557207062, 0.9913076310695066, 0.9912039949299534, 0.9910997473659748, 0.9909948884418758, 0.9908894182223387, 0.9907833367724228, 0.9906766441575645, 0.9905693404435773, 0.9904614256966512, 0.9903528999833537, 0.9902437633706288, 0.9901340159257975, 0.9900236577165575, 0.9899126888109834, 0.9898011092775262, 0.9896889191850139, 0.9895761186026509, 0.9894627076000184, 0.989348686247074, 0.9892340546141515, 0.9891188127719618, 0.9890029607915917, 0.9888864987445046, 0.9887694267025401, 0.9886517447379141, 0.9885334529232186, 0.9884145513314223, 0.9882950400358693, 0.9881749191102805, 0.9880541886287523, 0.9879328486657574, 0.9878108992961444, 0.9876883405951378, 0.9875651726383378, 0.9874413955017208, 0.9873170092616387, 0.9871920139948192, 0.9870664097783656, 0.9869401966897569, 0.9868133748068477, 0.986685944207868, 0.9865579049714237, 0.9864292571764954, 0.98630000090244, 0.9861701362289889, 0.9860396632362493, 0.9859085820047033, 0.9857768926152087, 0.985644595148998, 0.9855116896876789, 0.9853781763132342, 0.9852440551080216, 0.9851093261547739, 0.9849739895365986, 0.9848380453369782, 0.9847014936397698, 0.9845643345292053, 0.9844265680898916, 0.9842881944068098, 0.9841492135653157, 0.9840096256511397, 0.9838694307503867, 0.9837286289495359, 0.9835872203354409, 0.9834452049953297, 0.9833025830168044, 0.9831593544878415, 0.9830155194967916, 0.9828710781323792, 0.9827260304837031, 0.9825803766402359, 0.9824341166918242, 0.9822872507286887, 0.9821397788414234, 0.9819917011209965, 0.9818430176587499, 0.9816937285463989, 0.9815438338760325, 0.9813933337401133, 0.9812422282314773, 0.9810905174433341, 0.9809382014692664, 0.9807852804032304, 0.9806317543395556, 0.9804776233729444, 0.9803228875984726, 0.980167547111589, 0.9800116020081155, 0.9798550523842469, 0.9796978983365506, 0.9795401399619674, 0.9793817773578104, 0.9792228106217657, 0.979063239851892, 0.9789030651466206, 0.9787422866047552, 0.9785809043254721, 0.9784189184083201, 0.97825632895322, 0.9780931360604654, 0.9779293398307218, 0.9777649403650269, 0.9775999377647907, 0.9774343321317949, 0.9772681235681935, 0.9771013121765122, 0.9769338980596487, 0.9767658813208724, 0.9765972620638246, 0.976428040392518, 0.976258216411337, 0.9760877902250377, 0.9759167619387474, 0.9757451316579651, 0.9755728994885607, 0.9754000655367759, 0.9752266299092234, 0.9750525927128869, 0.9748779540551212, 0.9747027140436524, 0.9745268727865771, 0.9743504303923632, 0.9741733869698493, 0.9739957426282445, 0.9738174974771289, 0.9736386516264529, 0.9734592051865377, 0.973279158268075, 0.9730985109821265, 0.9729172634401249, 0.9727354157538723, 0.972552968035542, 0.9723699203976766, 0.9721862729531892, 0.9720020258153627, 0.97181717909785, 0.971631732914674, 0.971445687380227, 0.9712590426092713, 0.9710717987169388, 0.970883955818731, 0.9706955140305188, 0.9705064734685425, 0.9703168342494118, 0.9701265964901058, 0.9699357603079727, 0.9697443258207298, 0.9695522931464635, 0.9693596624036293, 0.9691664337110514, 0.968972607187923, 0.968778182953806, 0.9685831611286311, 0.9683875418326976, 0.9681913251866732, 0.9679945113115943, 0.9677971003288655, 0.9675990923602598, 0.9674004875279185, 0.9672012859543511, 0.967001487762435, 0.966801093075416, 0.9666001020169073, 0.9663985147108906, 0.9661963312817148, 0.9659935518540969, 0.9657901765531215, 0.9655862055042406, 0.9653816388332739, 0.9651764766664084, 0.9649707191301983, 0.9647643663515653, 0.9645574184577981, 0.9643498755765526, 0.9641417378358517, 0.9639330053640852, 0.9637236782900097, 0.9635137567427488, 0.9633032408517924, 0.9630921307469976, 0.9628804265585876, 0.9626681284171521, 0.9624552364536473, 0.9622417507993957, 0.9620276715860859, 0.9618129989457728, 0.9615977330108771, 0.961381873914186, 0.9611654217888519, 0.9609483767683935, 0.960730738986695, 0.9605125085780064, 0.9602936856769431, 0.960074270418486, 0.9598542629379817, 0.9596336633711416, 0.9594124718540429, 0.9591906885231273, 0.9589683135152021, 0.9587453469674393, 0.9585217890173758, 0.9582976398029137, 0.9580728994623192, 0.9578475681342234, 0.9576216459576222, 0.9573951330718756, 0.9571680296167083, 0.9569403357322088, 0.9567120515588304, 0.9564831772373903, 0.9562537129090695, 0.9560236587154131, 0.9557930147983301, 0.9555617813000934, 0.9553299583633394, 0.955097546131068, 0.954864544746643, 0.9546309543537911, 0.9543967750966026, 0.9541620071195313, 0.9539266505673936, 0.9536907055853693, 0.9534541723190012, 0.953217050914195, 0.9529793415172189, 0.952741044274704, 0.9525021593336441, 0.9522626868413954, 0.9520226269456766, 0.9517819797945687, 0.9515407455365149, 0.9512989243203208, 0.9510565162951535, 0.9508135216105429, 0.95056994041638, 0.950325772862918, 0.9500810191007717, 0.9498356792809176, 0.9495897535546937, 0.949343242073799, 0.9490961449902946, 0.9488484624566021, 0.9486001946255046, 0.9483513416501462, 0.948101903684032, 0.9478518808810277, 0.94760127339536, 0.9473500813816162, 0.9470983049947443, 0.9468459443900523, 0.9465929997232092, 0.9463394711502437, 0.9460853588275453, 0.945830662911863, 0.9455753835603061, 0.9453195209303438, 0.9450630751798048, 0.944806046466878, 0.9445484349501115, 0.9442902407884131, 0.9440314641410498, 0.943772105167648, 0.9435121640281936, 0.9432516408830312, 0.9429905358928644, 0.9427288492187562, 0.942466581022128, 0.9422037314647598, 0.9419403007087906, 0.9416762889167177, 0.9414116962513968, 0.941146522876042, 0.9408807689542255, 0.9406144346498777, 0.940347520127287, 0.9400800255510996, 0.9398119510863197, 0.9395432968983091, 0.939274063152787, 0.9390042500158307, 0.9387338576538741, 0.938462886233709, 0.9381913359224842, 0.9379192068877054, 0.9376464992972356, 0.9373732133192946, 0.9370993491224588, 0.9368249068756614, 0.9365498867481923, 0.9362742889096977, 0.93599811353018, 0.9357213607799982, 0.9354440308298674, 0.9351661238508584, 0.9348876400143983, 0.93460857949227, 0.934328942456612, 0.9340487290799185, 0.9337679395350391, 0.9334865739951791, 0.9332046326338986, 0.9329221156251134, 0.9326390231430941, 0.9323553553624665, 0.932071112458211, 0.9317862946056629, 0.9315009019805123, 0.9312149347588036, 0.9309283931169358, 0.930641277231662, 0.93035358728009, 0.9300653234396813, 0.9297764858882513, 0.92948707480397, 0.9291970903653602, 0.9289065327512992, 0.9286154021410173, 0.9283236987140987, 0.9280314226504806, 0.9277385741304536, 0.9274451533346613, 0.9271511604441005, 0.9268565956401208, 0.9265614591044244, 0.9262657510190666, 0.9259694715664549, 0.9256726209293492, 0.9253751992908621, 0.925077206834458, 0.9247786437439538, 0.9244795102035182, 0.9241798063976717, 0.9238795325112867, 0.9235786887295874, 0.923277275238149, 0.9229752922228988, 0.9226727398701148, 0.9223696183664268, 0.9220659278988153, 0.9217616686546116, 0.9214568408214985, 0.9211514445875087, 0.9208454801410263, 0.9205389476707853, 0.9202318473658704, 0.9199241794157165, 0.9196159440101086, 0.9193071413391819, 0.9189977715934213, 0.9186878349636618, 0.9183773316410876, 0.9180662618172328, 0.9177546256839811, 0.9174424234335652, 0.9171296552585672, 0.916816321351918, 0.9165024219068979, 0.916187957117136, 0.9158729271766095, 0.9155573322796452, 0.9152411726209175, 0.9149244483954498, 0.9146071597986136, 0.9142893070261281, 0.9139708902740612, 0.9136519097388281, 0.9133323656171922, 0.9130122581062643, 0.9126915874035028, 0.9123703537067135, 0.9120485572140494, 0.9117261981240109, 0.9114032766354453, 0.9110797929475466, 0.9107557472598559, 0.9104311397722609, 0.9101059706849957, 0.909780240198641, 0.9094539485141238, 0.9091270958327171, 0.9087996823560401, 0.9084717082860578, 0.9081431738250813, 0.907814079175767, 0.9074844245411169, 0.9071542101244788, 0.9068234361295454, 0.9064921027603547, 0.9061602102212898, 0.9058277587170788, 0.9054947484527943, 0.9051611796338539, 0.9048270524660196, 0.9044923671553977, 0.904157123908439, 0.9038213229319384, 0.9034849644330348, 0.903148048619211, 0.9028105756982937, 0.902472545878453, 0.9021339593682028, 0.9017948163764002, 0.9014551171122457, 0.9011148617852828, 0.9007740506053981, 0.900432683782821, 0.9000907615281238, 0.8997482840522215, 0.8994052515663711, 0.8990616642821723, 0.8987175224115672, 0.8983728261668397, 0.8980275757606156, 0.897681771405863, 0.8973354133158912, 0.8969885017043513, 0.8966410367852359, 0.8962930187728787, 0.8959444478819547, 0.8955953243274801, 0.8952456483248117, 0.8948954200896472, 0.8945446398380251, 0.8941933077863242, 0.8938414241512638, 0.8934889891499034, 0.8931360029996426, 0.8927824659182209, 0.8924283781237179, 0.8920737398345526, 0.891718551269484, 0.8913628126476099, 0.8910065241883679, 0.8906496861115346, 0.8902922986372257, 0.8899343619858957, 0.889575876378338, 0.8892168420356844, 0.8888572591794054, 0.8884971280313098, 0.8881364488135445, 0.8877752217485947, 0.8874134470592833, 0.887051124968771, 0.8866882557005565, 0.8863248394784756, 0.8859608765267019, 0.8855963670697458, 0.8852313113324553, 0.8848657095400148, 0.8844995619179461, 0.8841328686921074, 0.8837656300886935, 0.8833978463342355, 0.8830295176556011, 0.8826606442799938, 0.8822912264349533, 0.881921264348355, 0.8815507582484102, 0.8811797083636657, 0.8808081149230036, 0.8804359781556415, 0.880063298291132, 0.8796900755593626, 0.8793163101905562, 0.8789420024152699, 0.8785671524643954, 0.8781917605691592, 0.8778158269611217, 0.8774393518721777, 0.877062335534556, 0.8766847781808192, 0.8763066800438636, 0.8759280413569192, 0.8755488623535492, 0.8751691432676505, 0.8747888843334528, 0.8744080857855189, 0.8740267478587443, 0.8736448707883578, 0.8732624548099202, 0.8728795001593247, 0.8724960070727972, 0.8721119757868953, 0.8717274065385089, 0.8713422995648596, 0.8709566551035008, 0.8705704733923175, 0.8701837546695257, 0.8697964991736731, 0.8694087071436382, 0.8690203788186308, 0.8686315144381912, 0.8682421142421907, 0.8678521784708305, 0.8674617073646429, 0.86707070116449, 0.8666791601115641, 0.8662870844473874, 0.8658944744138118, 0.865501330253019, 0.86510765220752, 0.8647134405201551, 0.864318695434094, 0.8639234171928353, 0.8635276060402065, 0.8631312622203637, 0.8627343859777918, 0.862336977557304, 0.8619390372040416, 0.8615405651634744, 0.8611415616814, 0.8607420270039436, 0.8603419613775585, 0.8599413650490251, 0.8595402382654512, 0.8591385812742725, 0.8587363943232506, 0.858333677660475, 0.8579304315343613, 0.8575266561936522, 0.8571223518874167, 0.8567175188650497, 0.8563121573762726, 0.855906267671133, 0.8554998500000038, 0.855092904613584, 0.8546854317628979, 0.8542774316992952, 0.8538689046744509, 0.8534598509403648, 0.853050270749362, 0.8526401643540922, 0.8522295320075295, 0.8518183739629726, 0.8514066904740443, 0.8509944817946918, 0.8505817481791862, 0.8501684898821222, 0.8497547071584184, 0.8493404002633166, 0.8489255694523822, 0.8485102149815037, 0.8480943371068925, 0.8476779360850832, 0.8472610121729327, 0.8468435656276208, 0.8464255967066491, 0.8460071056678422, 0.8455880927693462, 0.8451685582696296, 0.8447485024274819, 0.8443279255020151, 0.8439068277526618, 0.8434852094391766, 0.8430630708216347, 0.8426404121604322, 0.8422172337162865, 0.8417935357502353, 0.8413693185236366, 0.840944582298169, 0.8405193273358313, 0.8400935538989418, 0.8396672622501393, 0.8392404526523817, 0.8388131253689466, 0.838385280663431, 0.837956918799751, 0.8375280400421418, 0.837098644655157, 0.8366687329036698, 0.836238305052871, 0.8358073613682703, 0.8353759021156952, 0.8349439275612917, 0.8345114379715233, 0.8340784336131711, 0.8336449147533344, 0.833210881659429, 0.8327763345991885, 0.8323412738406635, 0.8319056996522209, 0.8314696123025452, 0.8310330120606367, 0.8305958991958127, 0.8301582739777059, 0.8297201366762659, 0.8292814875617576, 0.8288423269047619, 0.8284026549761752, 0.8279624720472091, 0.8275217783893907, 0.8270805742745618, 0.8266388599748795, 0.8261966357628151, 0.825753901911155, 0.8253106586929996, 0.8248669063817634, 0.8244226452511754, 0.8239778755752779, 0.8235325976284275, 0.8230868116852936, 0.8226405180208598, 0.8221937169104222, 0.8217464086295903, 0.8212985934542861, 0.8208502716607448, 0.8204014435255136, 0.8199521093254523, 0.8195022693377328, 0.8190519238398392, 0.8186010731095669, 0.8181497174250234, 0.8176978570646277, 0.8172454923071099, 0.8167926234315112, 0.8163392507171839, 0.8158853744437913, 0.8154309948913068, 0.8149761123400147, 0.8145207270705094, 0.8140648393636953, 0.813608449500787, 0.8131515577633086, 0.812694164433094, 0.8122362697922861, 0.8117778741233377, 0.81131897770901, 0.8108595808323734, 0.8103996837768072, 0.8099392868259987, 0.8094783902639441, 0.8090169943749475, 0.8085550994436209, 0.8080927057548846, 0.8076298135939659, 0.8071664232464003, 0.80670253499803, 0.8062381491350047, 0.805773265943781, 0.8053078857111219, 0.8048420087240977, 0.8043756352700845, 0.8039087656367649, 0.8034414001121276, 0.8029735389844671, 0.8025051825423837, 0.8020363310747831, 0.8015669848708766, 0.8010971442201803, 0.8006268094125157, 0.8001559807380088, 0.7996846584870906, 0.799212842950496, 0.7987405344192648, 0.7982677331847408, 0.797794439538571, 0.7973206537727071, 0.7968463761794039, 0.7963716070512197, 0.7958963466810158, 0.7954205953619569, 0.79494435338751, 0.7944676210514454, 0.7939903986478354, 0.7935126864710547, 0.7930344848157802, 0.7925557939769908, 0.792076614249967, 0.791596945930291, 0.7911167893138462, 0.7906361446968174, 0.7901550123756903, 0.7896733926472517, 0.7891912858085884, 0.7887086921570886, 0.78822561199044, 0.7877420456066309, 0.7872579933039492, 0.7867734553809828, 0.7862884321366189, 0.7858029238700444, 0.785316930880745, 0.7848304534685056, 0.78434349193341, 0.7838560465758406, 0.7833681176964782, 0.7828797055963016, 0.7823908105765881, 0.7819014329389128, 0.7814115729851482, 0.7809212310174647, 0.7804304073383297, 0.7799391022505081, 0.7794473160570614, 0.7789550490613483, 0.7784623015670233, 0.7779690738780384, 0.7774753662986409, 0.7769811791333745, 0.7764865126870786, 0.7759913672648884, 0.7754957431722345, 0.7749996407148426, 0.7745030601987338, 0.7740060019302238, 0.7735084662159232, 0.773010453362737, 0.7725119636778645, 0.7720129974687991, 0.7715135550433284, 0.7710136367095335, 0.7705132427757891, 0.7700123735507636, 0.769511029343418, 0.7690092104630066, 0.7685069172190766, 0.7680041499214677, 0.7675009088803121, 0.766997194406034, 0.7664930068093498, 0.7659883464012679, 0.7654832134930881, 0.7649776083964018, 0.7644715314230915, 0.7639649828853312, 0.7634579630955851, 0.7629504723666087, 0.7624425110114478, 0.7619340793434385, 0.7614251776762068, 0.7609158063236691, 0.7604059656000309, 0.7598956558197879, 0.7593848772977246, 0.758873630348915, 0.7583619152887219, 0.7578497324327966, 0.7573370820970796, 0.7568239645977992, 0.7563103802514719, 0.7557963293749026, 0.7552818122851835, 0.7547668292996949, 0.7542513807361038, 0.753735466912365, 0.7532190881467199, 0.7527022447576971, 0.7521849370641115, 0.7516671653850642, 0.7511489300399432, 0.7506302313484218, 0.7501110696304596, 0.7495914452063014, 0.749071358396478, 0.7485508095218046, 0.7480297989033825, 0.7475083268625968, 0.7469863937211176, 0.7464639998009, 0.7459411454241821, 0.7454178309134873, 0.744894056591622, 0.7443698227816767, 0.7438451298070251, 0.743319977991324, 0.7427943676585137, 0.7422682991328169, 0.7417417727387392, 0.7412147888010684, 0.7406873476448749, 0.7401594495955105, 0.7396310949786097, 0.7391022841200879, 0.7385730173461422, 0.7380432949832512, 0.7375131173581738, 0.7369824847979507, 0.7364513976299024, 0.7359198561816304, 0.7353878607810158, 0.7348554117562205, 0.7343225094356856, 0.733789154148132, 0.7332553462225601, 0.7327210859882493, 0.7321863737747585, 0.7316512099119247, 0.7311155947298641, 0.730579528558971, 0.7300430117299178, 0.7295060445736552, 0.7289686274214116, 0.7284307606046926, 0.7278924444552817, 0.7273536793052393, 0.7268144654869028, 0.7262748033328864, 0.7257346931760809, 0.7251941353496532, 0.7246531301870467, 0.7241116780219804, 0.7235697791884493, 0.7230274340207239, 0.7224846428533498, 0.721941406021148, 0.7213977238592142, 0.7208535967029188, 0.7203090248879068, 0.7197640087500977, 0.7192185486256845, 0.7186726448511346, 0.7181262977631888, 0.7175795076988615, 0.7170322749954402, 0.7164845999904856, 0.7159364830218312, 0.7153879244275829, 0.7148389245461194, 0.7142894837160912, 0.7137396022764213, 0.7131892805663039, 0.7126385189252054, 0.712087317692863, 0.7115356772092853, 0.7109835978147521, 0.7104310798498135, 0.7098781236552903, 0.7093247295722739, 0.7087708979421253, 0.708216629106476, 0.7076619234072266, 0.7071067811865476,
];

pub fn sqrt<T>(x: T) -> T
    where T: Copy + Sub<T, Output=T> + Add<T, Output=T> + Div<T, Output=T> + PartialOrd + From<f32> + Into<f32>{
    let mut guess = x / T::from(2.0); // Start with an initial guess, usually x/2
    let mut prev_guess = T::from(0.0);

    while (guess - prev_guess).into().abs() > 0.0001 {
        prev_guess = guess;
        guess = (guess + x / guess) / T::from(2.0);
    }

    guess
}

pub fn sincos<T>(theta: T) -> (T,T)
    where T: Copy + Sub<T, Output=T> + Mul<T, Output=T> + Add<T, Output=T> + Div<T, Output=T> + Rem<T, Output=T> + PartialOrd + Neg<Output=T> + From<f32> + Into<f32>{

    let bounded = ((theta + T::from(PI)) % T::from(PI * 2.0)) - T::from(PI);
    let index = (((((T::from(bounded.into().abs()) + T::from(FRAC_PI_4)) % T::from(FRAC_PI_2)) - T::from(FRAC_PI_4)) / T::from(FRAC_PI_4)).into().abs() * 1000.0) as usize;

    let value = T::from(COS_PI_4_LOOK_UP[index]);
    let other = sqrt(T::from(1.0) - (value*value));

    if bounded < T::from(0.0){
        if bounded.into() < -FRAC_PI_2{
            if bounded.into() < -3.0 * FRAC_PI_4{
                (-other,-value)
            } else {
                (-value,-other)
            }
        } else if bounded.into() < -FRAC_PI_4{
            (-value,other)
        } else {
            (-other,value)
        }
    }else if bounded.into() < FRAC_PI_2{
        if bounded.into() < FRAC_PI_4{
            (other,value)
        } else {
            (value,other)
        }
    } else if bounded.into() < 3.0 * FRAC_PI_4{
        (value,-other)
    } else {
        (other,-value)
    }
}

pub fn sin<T>(theta: T) -> T
    where T: Copy + Sub<T, Output=T> + Mul<T, Output=T> + Add<T, Output=T> + Div<T, Output=T> + Rem<T, Output=T> + PartialOrd + Neg<Output=T> + From<f32> + Into<f32>{
    sincos(theta).0
}

pub fn cos<T>(theta: T) -> T
    where T: Copy + Sub<T, Output=T> + Mul<T, Output=T> + Add<T, Output=T> + Div<T, Output=T> + Rem<T, Output=T> + PartialOrd + Neg<Output=T> + From<f32> + Into<f32>{
    sincos(theta).1
}

pub fn expj<T>(theta: T) -> Complex<T>
    where T: Copy + Sub<T, Output=T> + Mul<T, Output=T> + Add<T, Output=T> + Div<T, Output=T> + Rem<T, Output=T> + PartialOrd + Neg<Output=T> + From<f32> + Into<f32>{
    
    let sc = sincos(theta);
    
    Complex{
           re: sc.1,
           im: sc.0,
       }
}